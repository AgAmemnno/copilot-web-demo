<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Github Communication" />
    <meta name="keywords" content="Github, Communication, API" />

    <title>GithubCommunication</title>
    <meta name="author" content="AgAmemnno" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./index.css"/>
    <script type="importmap">
      {
        "imports": {
          "@google/genai": "https://esm.sh/@google/genai"
        }
      }
    </script>
  </head>

  <body class="bg-gray-50 text-gray-800">
    <div id="inputPanel" class="input-panel">
        <div class="mb-4">
            <label for="modeSelector" class="block mb-2 text-sm font-medium text-gray-700">処理モードを選択:</label>
            <select id="modeSelector" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-teal-500 focus:border-teal-500 block w-full p-2.5">
                <option value="setPat" selected>Patを設定</option>
                <option value="toUpperCase">大文字に変換して設定</option>
                <option value="addToList">リストに追加</option>
                <option value="setObjectProperty">オブジェクトにプロパティ設定</option>
            </select>
        </div>

        <h3 id="inputPromptMessage" class="text-md font-semibold mb-3 text-gray-700">値を入力してください:</h3>
        <input type="text" id="valueInput"
               class="border border-gray-300 p-2 w-full rounded mb-4 focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none" placeholder="ここに値を入力"/>
        
        <div id="objectPropertyInputContainer" class="mb-4 hidden"> <label for="objectPropertyKey" class="block mb-1 text-sm font-medium text-gray-700">プロパティ名:</label>
             <input type="text" id="objectPropertyKey"
                   class="border border-gray-300 p-2 w-full rounded mb-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none" placeholder="例: name"/>
        </div>


        <div class="flex justify-end space-x-2">
            <button id="clearInputButton"
                    class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-md text-sm">
                クリア
            </button>
            <button id="processInputButton"
                    class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-md text-sm">
                実行
            </button>
        </div>
    </div>
    <script type="module"> 
      import { http, HttpResponse } from 'https://cdn.jsdelivr.net/npm/msw@2.7.3/+esm';
      import { setupWorker } from 'https://cdn.jsdelivr.net/npm/msw@2.7.3/browser/+esm';

const GOOGLE_DOCS_API_BASE_URL = 'https://docs.googleapis.com/v1';

export const handlers = [
  http.post(`${GOOGLE_DOCS_API_BASE_URL}/documents`, async ({ request }) => {
    const requestBody = await request.json();
    const title = requestBody?.title || 'Untitled Document';
    const newDocumentId = `mock_doc_${Date.now()}`; // 一意のモックIDを生成

    // 成功レスポンス
    return HttpResponse.json({
      documentId: newDocumentId,
      title: title,
      body: {
        content: [
          // 必要に応じて初期コンテンツの構造をモック
          {
            endIndex: 1,
            sectionBreak: {
              sectionStyle: {
                columnSeparatorStyle: 'NONE',
                contentDirection: 'LEFT_TO_RIGHT',
                sectionType: 'CONTINUOUS',
              },
            },
          },
        ],
      },
      documentStyle: {
        // ドキュメントスタイルのモック
      },
      namedStyles: {
        // 名前付きスタイルのモック
      },
      revisionId: 'mock_revision_id_0',
      suggestionsViewMode: 'SUGGESTIONS_INLINE',
      inlineObjects: {},
      // 他の必要なフィールド
    });

    // // エラーレスポンスの例 (必要に応じて切り替える)
    // return HttpResponse.json(
    //   {
    //     error: {
    //       code: 400,
    //       message: 'Invalid request payload for document creation.',
    //       status: 'INVALID_ARGUMENT',
    //     },
    //   },
    //   { status: 400 }
    // );
  }),
  // 他のハンドラもここに追加
];
    
    // src/main.js (アプリケーションのエントリーポイント)

async function prepareApp() {
  if (process.env.NODE_ENV === 'development') { // 開発環境でのみMSWを有効化
    const { worker } = await import('./mockServiceWorker'); // 動的インポート

    // worker.start() を呼び出してサービスワーカーを登録・起動
    return worker.start({
      onUnhandledRequest: 'bypass', // モックがないリクエストの処理方法
      // quiet: true, // コンソールへのMSW関連のログ出力を抑制
      // serviceWorker: { // 高度なオプション
      //   url: '/mockServiceWorker.js', // カスタムパス
      //   options: { scope: '/' } // サービスワーカーのスコープ
      // }
    });
  }
  return Promise.resolve();
}

prepareApp().then(() => {
  // アプリケーションのレンダリングや初期化
  // 例: ReactDOM.render(<App />, document.getElementById('root'));
});
    
    </script>
  </body>
</html>