name: Event Payload Inspector

# ä»¥å‰æ¤œè¨ã—ãŸã»ã¼å…¨ã¦ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦å®šç¾©ã—ã¾ã™
on:
  push: # branches, tags, paths ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ã“ã“ã§ã¯çœç•¥ï¼ˆã©ã‚“ãªpushã§ã‚‚åå¿œã™ã‚‹ã‚ˆã†ã«ï¼‰
  pull_request: # types, branches ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚‚ã“ã“ã§ã¯çœç•¥
  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œã€å…¥åŠ›ã‚‚å—ã‘ä»˜ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«å®šç¾©
    inputs:
      sample_text:
        description: 'A sample text input for dispatch'
        required: false
        type: string
        default: 'Hello from dispatch'
      sample_boolean:
        description: 'A sample boolean input'
        required: false
        type: boolean
        default: true
  schedule:
    - cron: '59 23 31 12 5' # å®Ÿéš›ã«ã¯å®Ÿè¡Œã•ã‚Œãªã„ã‚ˆã†ãªæœªæ¥ã®æ—¥ä»˜ (actã§ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚)
  release:
    types: [created, published, edited] # ä»£è¡¨çš„ãªã‚‚ã®
  # workflow_call ã¯å˜ç‹¬ã§ act ã§ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ã®ãŒå°‘ã—ç‰¹æ®Šãªã®ã§ã€
  # ã“ã“ã§ã¯å‘¼ã³å‡ºã•ã‚Œã‚‹å´ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã—ã¦ã§ã¯ãªãã€
  # ã‚‚ã—ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è‡ªä½“ãŒå‘¼ã³å‡ºã•ã‚ŒãŸå ´åˆã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹æƒ³å®šã¯å«ã‚ã¾ã›ã‚“ã€‚
  # workflow_call ã®ãƒ†ã‚¹ãƒˆã¯ã€å‘¼ã³å‡ºã—å…ƒã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ act ã§å®Ÿè¡Œã—ã€
  # å‘¼ã³å‡ºã•ã‚Œã‚‹å´ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã« secrets ã‚„ inputs ãŒæ¸¡ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã®ãŒä¸»ã§ã™ã€‚
  # ãŸã ã—ã€ã‚‚ã— `act workflow_call -e payload.json` ã®ã‚ˆã†ã«ç›´æ¥ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆã®
  # ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰å†…å®¹ç¢ºèªç”¨ã¨ã—ã¦ github.event.inputs ã‚’è¡¨ç¤ºã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã¯å«ã‚ã¾ã™ã€‚
  workflow_call: # ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå‘¼ã³å‡ºã•ã‚ŒãŸå ´åˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨
    inputs:
      caller_message:
        type: string
        required: false
        default: 'Message from caller'
    # secrets: # secrets ã¯ act ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æ¸¡ã™ãŸã‚ã€ã“ã“ã§ã¯å®šç¾©ã®ã¿
    #   CALLER_SECRET_EXAMPLE:     //       required: false

  issues:
    types: [opened, labeled, closed] # ä»£è¡¨çš„ãªã‚‚ã®
  issue_comment:
    types: [created, edited] # ä»£è¡¨çš„ãªã‚‚ã®
  repository_dispatch:
    types: [custom-event-type-1, custom-event-type-2] # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å´ã§ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹type

jobs:
  inspect_event_payload:
    runs-on: ubuntu-latest # actãŒåˆ©ç”¨ã™ã‚‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ™ãƒ¼ã‚¹
    steps:
      - name: Display Basic Event Information
        run: |
          echo "ğŸ‰ Event Inspector Workflow Triggered!"
          echo "---------------------------------------"
          echo "Event Name    : ${{ github.event_name }}"
          echo "Ref           : ${{ github.ref }}"
          echo "SHA           : ${{ github.sha }}"
          echo "Actor         : ${{ github.actor }}"
          echo "Workflow Name : ${{ github.workflow }}"
          echo "Run ID        : ${{ github.run_id }} (Note: May be a dummy value in act)"
          echo "Run Number    : ${{ github.run_number }} (Note: May be a dummy value in act)"
          echo "---------------------------------------"

      - name: Display Full Event Payload (JSON)
        run: |
          echo "å®Œæ•´çš„äº‹ä»¶è´Ÿè½½ (Full Event Payload as JSON):"
          echo "${{ toJSON(github.event) }}"
          echo "---------------------------------------"

      # --- ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã”ã¨ã®è©³ç´°æƒ…å ±è¡¨ç¤º ---

      - name: Push Event Specifics
        if: github.event_name == 'push'
        run: |
          echo "â¡ï¸ Push Event Details:"
          echo "  Pusher Name    : ${{ github.event.pusher.name }}"
          echo "  Pusher Email   : ${{ github.event.pusher.email }}"
          echo "  Head Commit ID : ${{ github.event.head_commit.id }}"
          echo "  Head Commit Msg: ${{ github.event.head_commit.message }}"
          echo "  Commits (first one):"
          echo "    Msg: ${{ github.event.commits[0].message }}"
          echo "    Author: ${{ github.event.commits[0].author.name }}"
          echo "---------------------------------------"

      - name: Pull Request Event Specifics
        if: github.event_name == 'pull_request'
        run: |
          echo "â¡ï¸ Pull Request Event Details:"
          echo "  Action         : ${{ github.event.action }}"
          echo "  PR Number      : ${{ github.event.number }}"
          echo "  PR Title       : ${{ github.event.pull_request.title }}"
          echo "  PR User        : ${{ github.event.pull_request.user.login }}"
          echo "  Head Ref (from): ${{ github.event.pull_request.head.ref }} (SHA: ${{ github.event.pull_request.head.sha }})"
          echo "  Base Ref (to)  : ${{ github.event.pull_request.base.ref }} (SHA: ${{ github.event.pull_request.base.sha }})"
          echo "  Labels         : ${{ toJSON(github.event.pull_request.labels) }}"
          echo "---------------------------------------"

      - name: Workflow Dispatch Event Specifics
        if: github.event_name == 'workflow_dispatch'
        run: |
          echo "â¡ï¸ Workflow Dispatch Event Details:"
          echo "  Inputs Received: ${{ toJSON(github.event.inputs) }}"
          echo "---------------------------------------"

      - name: Schedule Event Specifics
        if: github.event_name == 'schedule'
        run: |
          echo "â¡ï¸ Schedule Event Details:"
          echo "  Scheduled Cron String (from workflow definition): ${{ github.event.schedule }}"
          echo "  (Actual payload for 'schedule' is minimal from GitHub)"
          echo "---------------------------------------"

      - name: Release Event Specifics
        if: github.event_name == 'release'
        run: |
          echo "â¡ï¸ Release Event Details:"
          echo "  Action         : ${{ github.event.action }}"
          echo "  Tag Name       : ${{ github.event.release.tag_name }}"
          echo "  Release Name   : ${{ github.event.release.name }}"
          echo "  Published At   : ${{ github.event.release.published_at }}"
          echo "  Release Author : ${{ github.event.release.author.login }}"
          echo "---------------------------------------"

      - name: Workflow Call Event Specifics (if this workflow is called)
        if: github.event_name == 'workflow_call'
        run: |
          echo "â¡ï¸ Workflow Call Event Details (inputs for this called workflow):"
          echo "  Inputs Received: ${{ toJSON(github.event.inputs) }}"
          # secrets ã¯ ${{ secrets.SECRET_NAME }} ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ãŒã€echoã§è¡¨ç¤ºã™ã‚‹ã®ã¯é¿ã‘ã‚‹ã¹ãã§ã™ã€‚
          # echo "  (Secrets are not displayed directly for security reasons)"
          echo "  Caller Workflow Path (approx.): ${{ github.event.workflow }}" # Usually the path of the calling workflow definition
          echo "  Caller Repository (approx.): ${{ github.event.repository.full_name }}"
          echo "---------------------------------------"

      - name: Issues Event Specifics
        if: github.event_name == 'issues'
        run: |
          echo "â¡ï¸ Issues Event Details:"
          echo "  Action         : ${{ github.event.action }}"
          echo "  Issue Number   : ${{ github.event.issue.number }}"
          echo "  Issue Title    : ${{ github.event.issue.title }}"
          echo "  Issue Author   : ${{ github.event.issue.user.login }}"
          echo "  Issue Labels   : ${{ toJSON(github.event.issue.labels) }}"
          echo "---------------------------------------"

      - name: Issue Comment Event Specifics
        if: github.event_name == 'issue_comment'
        run: |
          echo "â¡ï¸ Issue Comment Event Details:"
          echo "  Action         : ${{ github.event.action }}"
          echo "  Issue Number   : ${{ github.event.issue.number }}" # Comment is on this issue/PR
          echo "  Comment Author : ${{ github.event.comment.user.login }}"
          echo "  Comment Body   : ${{ github.event.comment.body }}"
          echo "---------------------------------------"

      - name: Repository Dispatch Event Specifics
        if: github.event_name == 'repository_dispatch'
        run: |
          echo "â¡ï¸ Repository Dispatch Event Details:"
          echo "  Action (event_type) : ${{ github.event.action }}" # This is the 'type' you specified
          echo "  Client Payload      : ${{ toJSON(github.event.client_payload) }}"
          echo "---------------------------------------"
